# US Stock Dividend Dashboard MVP PRD

## 핵심 정보

**목적**: Notion에 기록된 미국 주식 배당 내역을 웹 대시보드에서 월별/종목별 통계와 원화 환산 금액으로 자동 시각화
**사용자**: 미국 주식에 투자하며 배당 수익을 체계적으로 관리하고자 하는 개인 투자자

---

## 사용자 여정

```
1. 대시보드 페이지 (랜딩)
   ↓ 페이지 로드 시

2. 데이터 로딩
   ↓ Notion API에서 배당 로그, 환율, 포트폴리오 데이터 가져오기

   [데이터 로드 성공] → 대시보드 렌더링
   [데이터 로드 실패] → 에러 메시지 표시 → 재시도 옵션
   ↓

3. 대시보드 표시
   ↓ 기본값: 현재 연도 데이터

4. 연도 선택 (선택적)
   ↓ 연도 변경 시 데이터 필터링 및 재계산
   ↓

5. 통계 확인
   - 월별 배당금 막대그래프 확인
   - 피벗 테이블에서 종목별/월별 배당금 확인
   - 원화 환산 금액 확인
```

---

## 기능 명세

### 1. MVP 핵심 기능

| ID | 기능명 | 설명 | MVP 필수 이유 | 관련 페이지 |
|----|--------|------|-------------|------------|
| **F001** | 배당 데이터 조회 | Notion API를 통해 배당 로그, 포트폴리오, 환율 데이터를 조회 | 모든 기능의 데이터 소스 | 대시보드 페이지 |
| **F002** | 연도 필터링 | 연도 선택 컴포넌트로 특정 연도 데이터만 필터링 | 연간 배당 수익 분석의 핵심 | 대시보드 페이지 |
| **F003** | 피벗 테이블 | 종목(행) × 월(열) 형태의 배당금 피벗 테이블 생성 | 종목별/월별 배당 현황 파악 | 대시보드 페이지 |
| **F004** | 환율 자동 계산 | 월별 환율 DB를 참조하여 원화 환산 금액 자동 계산 | 실제 수령 금액 파악 | 대시보드 페이지 |
| **F005** | 월별 차트 | 월별 배당금 추이를 막대그래프로 시각화 | 배당 수익 트렌드 시각화 | 대시보드 페이지 |

### 2. MVP 필수 지원 기능

| ID | 기능명 | 설명 | MVP 필수 이유 | 관련 페이지 |
|----|--------|------|-------------|------------|
| **F006** | 월별 합계 표시 | 피벗 테이블 Footer에 월별 총합계 ($, KRW) 표시 | 월간 수익 총합 파악 | 대시보드 페이지 |
| **F007** | 환율 예외 처리 | 환율 정보 없는 달은 최근 환율 또는 기본값 적용 | 데이터 누락 시에도 정상 작동 | 대시보드 페이지 |
| **F008** | 로딩/에러 상태 | 데이터 로딩 중 스켈레톤 UI, 에러 시 재시도 버튼 | 사용자 경험 향상 | 대시보드 페이지 |

### 3. MVP 이후 기능 (제외)

- 사용자 인증 (개인 대시보드이므로 MVP에서 제외)
- 다크모드 테마 전환
- 여러 연도 비교 기능
- 데이터 내보내기 (Excel, PDF)
- 종목별 상세 페이지
- 배당 예측 기능

---

## 메뉴 구조

```
📱 US Stock Dividend Dashboard 내비게이션
└── 📊 대시보드 (단일 페이지 애플리케이션)
    ├── 연도 선택기 - F002 (연도 필터링)
    ├── 요약 카드 영역 - F001, F004 (총 배당금, 원화 환산)
    ├── 월별 차트 - F005 (막대그래프)
    └── 피벗 테이블 - F003, F006 (종목×월 배당금 테이블)
```

---

## 페이지별 상세 기능

### 대시보드 페이지

> **구현 기능:** `F001`, `F002`, `F003`, `F004`, `F005`, `F006`, `F007`, `F008` | **메뉴 위치:** 메인 (단일 페이지)

| 항목 | 내용 |
|------|------|
| **역할** | 배당 데이터 조회, 통계 계산, 시각화를 제공하는 메인 대시보드 |
| **진입 경로** | 웹사이트 접속 시 자동으로 표시 (루트 페이지) |
| **사용자 행동** | 연도를 선택하여 해당 연도의 배당 통계를 확인하고, 차트와 테이블을 통해 월별/종목별 배당금을 분석 |
| **주요 기능** | • **연도 선택기**: Select 컴포넌트로 연도 선택<br>• **요약 카드**: 연간 총 배당금($), 원화 환산 총액(₩) 표시<br>• **월별 막대그래프**: X축 1~12월, Y축 배당금액<br>• **피벗 테이블**: 종목(행) × 월(열), 셀에 해당 월 배당금, Footer에 월별 합계($, ₩)<br>• **로딩 스켈레톤**: 데이터 로딩 중 표시<br>• **에러 핸들링**: 에러 발생 시 재시도 버튼 |
| **다음 이동** | 단일 페이지이므로 페이지 이동 없음 |

---

## 데이터 모델

### Portfolio (종목 마스터)
| 필드 | 설명 | 타입/관계 |
|------|------|----------|
| id | Notion 페이지 ID | String |
| name | 종목명 | String |
| ticker | 티커 심볼 | String |
| sector | 섹터 분류 | String |
| dividendFrequency | 배당주기 (월배당/분기배당 등) | String |

### ExchangeRate (월별 환율)
| 필드 | 설명 | 타입/관계 |
|------|------|----------|
| id | Notion 페이지 ID | String |
| month | 기준월 (YYYY-MM) | String |
| rate | 적용환율 | Number |
| baseDate | 기준일 | Date |

### DividendLog (배당 트랜잭션)
| 필드 | 설명 | 타입/관계 |
|------|------|----------|
| id | Notion 페이지 ID | String |
| paymentDate | 지급일 | Date |
| amount | 입금액 ($) | Number |
| portfolioId | 종목 참조 | → Portfolio.id |
| exchangeRateMonthId | 환율월 참조 | → ExchangeRate.id |

---

## 기술 스택 (최신 버전)

### 프론트엔드 프레임워크
- **Next.js 15** (App Router) - React 풀스택 프레임워크
- **TypeScript 5.6+** - 타입 안전성 보장
- **React 19** - UI 라이브러리

### 스타일링 & UI
- **TailwindCSS v4** - 유틸리티 CSS 프레임워크
- **shadcn/ui** - 고품질 React 컴포넌트 라이브러리
- **Lucide React** - 아이콘 라이브러리

### 데이터 테이블 & 차트
- **TanStack Table v8** - 헤드리스 데이터 테이블 (피벗 테이블 구현)
- **Recharts 2.x** - React 차트 라이브러리 (막대그래프)

### 백엔드 & API
- **Notion API** (@notionhq/client) - Notion 데이터베이스 연동
- **Next.js API Routes** - 서버사이드 API 엔드포인트

### 배포 & 호스팅
- **Vercel** - Next.js 15 최적화 배포 플랫폼

### 패키지 관리
- **npm** - 의존성 관리

---

## 정합성 검증 체크리스트

### 1단계: 기능 명세 → 페이지 연결 검증
- [x] F001~F008 모든 기능 ID가 대시보드 페이지에서 구현됨
- [x] 관련 페이지(대시보드 페이지)가 페이지별 상세 기능에 존재함

### 2단계: 메뉴 구조 → 페이지 연결 검증
- [x] 메뉴 구조의 모든 항목이 대시보드 페이지에 해당함
- [x] 메뉴에서 참조하는 F001~F008 모두 기능 명세에 정의됨

### 3단계: 페이지별 상세 기능 → 역참조 검증
- [x] 대시보드 페이지의 구현 기능 ID(F001~F008)가 모두 기능 명세에 정의됨
- [x] 대시보드 페이지가 메뉴 구조에서 접근 가능함

### 4단계: 누락 및 고아 항목 검증
- [x] 기능 명세의 모든 기능이 대시보드 페이지에서 구현됨
- [x] 대시보드 페이지의 모든 기능이 기능 명세에 정의됨
- [x] 메뉴의 모든 항목이 실제 페이지와 연결됨
